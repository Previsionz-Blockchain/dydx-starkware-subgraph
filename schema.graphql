enum ProxyEventType {
  ADDED
  UPGRADED
}

interface Event {
  id: ID!
  blockNumber: BigInt!
  blockHash: Bytes!
  transactionHash: Bytes!
  timestamp: BigInt!
}

type StateTransitionFact implements Event @entity {
  id: ID!
  blockNumber: BigInt!
  blockHash: Bytes!
  transactionHash: Bytes!
  timestamp: BigInt!
  # memoryPageFacts: [MemoryPageFact!]! @derivedFrom(field: "stateTransitionFact")
}

type MemoryPageFact implements Event @entity {
  id: ID!
  blockNumber: BigInt!
  blockHash: Bytes!
  transactionHash: Bytes!
  timestamp: BigInt!

  stateTransitionFact: Bytes!
  factHash: Bytes!
  memoryHash: String!
  prod: BigInt!

  input: Bytes!
}

type MemoryPageHash implements Event @entity {
  id: ID!
  blockNumber: BigInt!
  blockHash: Bytes!
  transactionHash: Bytes!
  timestamp: BigInt!

  factHash: Bytes!
  pagesHashes: [Bytes!]!
}

type MemoryPage @entity {
  id: ID! # transactionId
  startAddr: BigInt
  values: [BigInt!]!
  z: BigInt
  alpha: BigInt
  prime: BigInt
}

type ProxyEvent implements Event @entity {
  id: ID!
  blockNumber: BigInt!
  blockHash: Bytes!
  transactionHash: Bytes!
  timestamp: BigInt!

  type: ProxyEventType!
  implementation: Bytes!
  initializer: Bytes
  finalize: Boolean
}
